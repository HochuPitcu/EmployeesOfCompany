@model EmployeesOfCompany.Models.UserListViewModel

@{
    ViewData["Title"] = "Index";
}

<h2>Каталог пользователей</h2>
<div id="modDialog" class="modal fade">
    <div id="dialogContent" class="modal-dialog"></div>
</div>
<form method="get">
    <div class="form-row">
        <div class="form-group col-md-3">
            <div class="form-group">
                <label class="control-label">department: </label>
                <input name="department" class="form-control">
            </div>
            <div class="form-group">
                <label class="control-label">name: </label>
                <input name="fullname" class="form-control">
            </div>
        </div>
        <div class="form-group col-md-2">
            <div class="form-group">
                <label class="control-label">Birth: </label>
                <input type="date" name="birthDate" class="form-control">
            </div>
            <div class="form-group">
                <label class="control-label">Employment: </label>
                <input type="date" name="employmentDate" class="form-control">
            </div>
        </div>
        <div class="form-group col-md-2">
            <div class="form-group">
                <label class="control-label">Salary: </label>
                <input name="salary" class="form-control">
            </div>
            <div class="form-group" align="center">
                <p style="text-align: center">
                    <button type="submit" value="Фильтр">Фильтр</button>
                </p>
                @*<input type="submit" value="Фильтр" class="btn btn-default">*@
            </div>
        </div>
    </div>
</form>


<table class="table">
    <thead>
        <tr>
            <th>
                <a asp-action="Employee" asp-route-sortOrder="@ViewBag.DepartmentSort">Департамент</a>
            </th>
            <th>
                <a asp-action="Employee" asp-route-sortOrder="@ViewBag.NameSort">Ф.И.О.</a>
            </th>
            <th>
                <a asp-action="Employee" asp-route-sortOrder="@ViewBag.DateSort">Дата рождения</a>
            </th>
            <th>
                <a asp-action="Employee" asp-route-sortOrder="@ViewBag.EmploymentSort">Дату устройства на работу</a>
            </th>
            <th>
                <a asp-action="Employee" asp-route-sortOrder="@ViewBag.SalarySort">Заработная плата</a>
            </th>
            <th>
                @Html.ActionLink("Create New", "CreateOrEdit",new { id = 0 }, new { @class = "compItem" })
                @*<a asp-action="CreateOrEdit">Create New</a>*@
            </th>
        </tr>
    <thead>
    <tbody>
        @foreach (var item in Model.Employees) {
        <tr>
            <td>@Html.DisplayFor(modelItem => item.Department)</td>
            <td>@Html.DisplayFor(modelItem => item.FullName)</td>
            <td>@Html.DisplayFor(modelItem => item.DateOfBirth)</td>
            <td>@Html.DisplayFor(modelItem => item.DateOfEmployment)</td>
            <td>@Html.DisplayFor(modelItem => item.Salary)</td>

            <td>
            
                @Html.ActionLink("Edit", "CreateOrEdit", new { id = item.EmployeeId }, new { @class = "compItem" })
                @Html.ActionLink("Delete", "DeleteEmployee", new { id = item.EmployeeId }, new { @class = "compItem" })
            
            @*<a asp-action="CreateOrEdit" asp-route-id="@item.EmployeeId">Edit</a> |*@
            <a asp-action="Index" asp-route-id="@item.EmployeeId" onclick="return confirm('Вы уверены, что хотите удалить этого сотрудника?')">Delete</a>
            </td>
        </tr>

        }
    </tbody>
</table>
@section scripts
{
    <script type="text/javascript">

        $(function () {
            $.ajaxSetup({ cache: false });
            $(".compItem").click(function (e) {

                e.preventDefault();
                $.get(this.href, function (data) {
                    $('#dialogContent').html(data);
                    $('#modDialog').modal('show');
                });
            });
        })
    </script>
}